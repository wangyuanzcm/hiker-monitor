!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e||self).hikerMonitor=n()}(this,function(){var e;!function(e){e[e.URGENT=1]="URGENT",e[e.IDLE=2]="IDLE"}(e||(e={}));var n=window,t=n.console,o=document,r=n.navigator,i=n.performance,a=function(){var e;return null!=(e=r.deviceMemory)?e:0},c=function(){var e;return null!=(e=r.hardwareConcurrency)?e:0},s={reportData:new(function(){function t(e){var n=e.logUrl;if(!n)throw new Error("ËØ∑‰º†ÈÄíË¶ÅËÆ∞ÂΩïÊï∞ÊçÆÁöÑË∑ØÁî±~");this.logUrl=n}return t.prototype.sendToAnalytics=function(t,o,i){var a=this.logUrl;if(i&&(a=i),t==e.URGENT)if(n.fetch)fetch(a,{body:o,method:"POST",keepalive:!0});else{var c=new XMLHttpRequest;c.open("post",a,!0),c.setRequestHeader("Content-Type","application/json"),c.send(o),c.onload=function(e){c=null}}else if(t==e.IDLE)if(r.sendBeacon)navigator.sendBeacon(a,o);else{var s=new Image;s.src=a+"?body="+o,s.onload=function(){s=null}}},t}())({logUrl:"hole"}),isResourceTiming:!1,isElementTiming:!1,maxTime:15e3},l="4g",u=!1,f=function(){return!!(c()&&c()<=4)||!!(a()&&a()<=4)},d=function(e,n){switch(e){case"slow-2g":case"2g":case"3g":return!0;default:return f()||n}},v={isHidden:!1},p=function(e){o.hidden&&(e(),v.isHidden=o.hidden)},m=function(e){return parseFloat(e.toFixed(2))},g=function(e){return"number"!=typeof e?null:m(e/Math.pow(1024,2))},T=[1e3,2500],h=[2500,4e3],y=[100,300],E=[.1,.25],w=[300,600],k={fp:T,fcp:T,lcp:h,lcpFinal:h,fid:y,fidVitals:y,cls:E,clsFinal:E,tbt:w,tbt5S:w,tbt10S:w,tbtFinal:w},b=function(e,n){return k[e]?n<=k[e][0]?"good":n<=k[e][1]?"needsImprovement":"poor":null},S=function(e,t,o){var i;i=function(){v.isHidden&&e.indexOf("Final")<0||!s.analyticsTracker||s.analyticsTracker({metricName:e,data:t,eventProperties:o||{},navigatorInformation:r?{deviceMemory:a()||0,hardwareConcurrency:c()||0,serviceWorkerStatus:"serviceWorker"in r?r.serviceWorker.controller?"controlled":"supported":"unsupported",isLowEndDevice:f(),isLowEndExperience:d(l,u)}:{},vitalsScore:b(e,t)})},"requestIdleCallback"in n?n.requestIdleCallback(i,{timeout:3e3}):i()},D=function(e,n,t){Object.keys(n).forEach(function(e){"number"==typeof n[e]&&(n[e]=m(n[e]))}),S(e,n,t)},L=function(e,n,t){var o=m(e);o<=s.maxTime&&o>=0&&S(n,o,t)},R={value:0},I={value:0},U={value:0},x={value:{beacon:0,css:0,fetch:0,img:0,other:0,script:0,total:0,xmlhttprequest:0}},B={value:0},q=function(e){var n=e.pop();n&&!n.hadRecentInput&&n.value&&(R.value+=n.value)},F={},j=function(e,n){try{var o=new PerformanceObserver(function(e){n(e.getEntries())});return o.observe({type:e,buffered:!0}),o}catch(e){t.warn("Yideng.js:",e)}return null},C=function(e){F[e]&&F[e].disconnect(),delete F[e]},M=function(e){var n=e.pop();n&&(L(n.processingStart-n.startTime,"fidVitals",{performanceEntry:n}),L(n.duration,"fid",{performanceEntry:n})),C(1),L(U.value,"lcp"),F[3]&&"function"==typeof F[3].takeRecords&&F[3].takeRecords(),L(R.value,"cls"),L(B.value,"tbt"),setTimeout(function(){L(B.value,"tbt5S")},5e3),setTimeout(function(){L(B.value,"tbt10S"),D("dataConsumption",x.value)},1e4)},H=function(e){e.forEach(function(e){if(!("self"!==e.name||e.startTime<I.value)){var n=e.duration-50;n>0&&(B.value+=n)}})},O=function(e){e.forEach(function(e){"first-paint"===e.name?L(e.startTime,"fp"):"first-contentful-paint"===e.name&&(I.value=e.startTime,L(I.value,"fcp"),F[4]=j("longtask",H),C(0))})},N=function(e){var n=e.pop();n&&(U.value=n.renderTime||n.loadTime)},z=function(e){e.forEach(function(e){e.identifier&&L(e.startTime,e.identifier)})},P=function(e){e.forEach(function(e){if(s.isResourceTiming&&D("resourceTiming",e),e.decodedBodySize&&e.initiatorType){var n=e.decodedBodySize/1e3;x.value[e.initiatorType]+=n,x.value.total+=n}})},W=function(){F[2]&&(L(U.value,"lcpFinal"),C(2)),F[3]&&("function"==typeof F[3].takeRecords&&F[3].takeRecords(),L(R.value,"clsFinal"),C(3)),F[4]&&(L(B.value,"tbtFinal"),C(4))},G=function(){function t(){this.errordefo={}}var o=t.prototype;return o.globalError=function(){console.log("‰∏äÊä•sdk"),console.log("[ ‚ùåÂÖ®Â±ÄÊçïËé∑ÈîôËØØ ]"),n.onerror=function(n,t,o,r,i){console.log("[ ÊàëÁü•ÈÅìÈîôËØØ‰∫Ü ]",n);var a=JSON.stringify({scriptURI:t,lineno:o,colno:r,error:i});return console.log(a),s.reportData.sendToAnalytics(e.IDLE,a),!0}},o.networkError=function(){n.addEventListener("error",function(e){e.target!==n&&console.log("üñºÁΩëÁªúÈîôËØØ",e.target)},!0)},o.promiseError=function(){n.addEventListener("unhandledrejection",function(e){return e.preventDefault(),console.log("ÊàëÁü•ÈÅì promise ÁöÑÈîôËØØ‰∫Ü",e.reason),!0})},o.iframeError=function(){for(var e=n.frames,t=0;t<e.length;t++)e[t].addEventListener("error",function(e){console.log("addEventListener"),console.log(e)},!0),e[t].addEventListener("unhandledrejection",function(e){console.log("unhandledrejection")},!0)},o.run=function(){this.networkError(),this.globalError(),this.promiseError()},t}(),A=function(e){console.log(e)},V=function(){function t(e){var n=e.logUrl;if(!n)throw new Error("ËØ∑‰º†ÈÄíË¶ÅËÆ∞ÂΩïÊï∞ÊçÆÁöÑË∑ØÁî±~");this.logUrl=n}return t.prototype.sendToAnalytics=function(t,o,i){var a=this.logUrl;if(i&&(a=i),t==e.URGENT)if(n.fetch)fetch(a,{body:o,method:"POST",keepalive:!0});else{var c=new XMLHttpRequest;c.open("post",a,!0),c.setRequestHeader("Content-Type","application/json"),c.send(o),c.onload=function(e){c=null}}else if(t==e.IDLE)if(r.sendBeacon)navigator.sendBeacon(a,o);else{var s=new Image;s.src=a+"?body="+o,s.onload=function(){s=null}}},t}(),X=function(e){var n="usageDetails"in e?e.usageDetails:{};D("storageEstimate",{quota:g(e.quota),usage:g(e.usage),caches:g(n.caches),indexedDB:g(n.indexedDB),serviceWorker:g(n.serviceWorkerRegistrations)})};return function(e){void 0===e&&(e={}),this.v="1.0.0";var t=e.logUrl;if(!t)throw new Error("‰∫¨Á®ã‰∏ÄÁÅØÁ≥ªÁªüÁõëÊéßÂπ≥Âè∞"+this.v+"ÊèêÁ§∫Êú™‰º†ÈÄílogUrl");var a=new V({logUrl:t});s.reportData=a,this.reportData=a,s.analyticsTracker=e.analyticsTracker||A,s.isResourceTiming=!!e.resourceTiming,s.isElementTiming=!!e.elementTiming,s.maxTime=e.maxMeasureTime||s.maxTime,e.captureError&&(new G).run(),i&&i.getEntriesByType&&i.now&&i.mark&&("PerformanceObserver"in n&&(console.log("‚è∞ ÊÄßËÉΩÊî∂ÈõÜÂºÄÂßã",Math.random()),F[0]=j("paint",O),F[1]=j("first-input",M),F[2]=j("largest-contentful-paint",N),s.isResourceTiming&&(console.log("üìö Êî∂ÈõÜÈ°µÈù¢ÊÄßËÉΩÊï∞ÊçÆ"),j("resource",P)),F[3]=j("layout-shift",q),s.isElementTiming&&j("element",z)),void 0!==o.hidden&&o.addEventListener("visibilitychange",p.bind(this,W)),D("navigationTiming",function(){if(!(i&&i.getEntriesByType&&i.now&&i.mark))return{};var e=i.getEntriesByType("navigation")[0];if(!e)return{};var n=e.responseStart,t=e.responseEnd;return{fetchTime:t-e.fetchStart,workerTime:e.workerStart>0?t-e.workerStart:0,totalTime:t-e.requestStart,downloadTime:t-n,timeToFirstByte:n-e.requestStart,headerSize:e.transferSize-e.encodedBodySize||0,dnsLookupTime:e.domainLookupEnd-e.domainLookupStart,tcpTime:e.connectEnd-e.connectStart||0,whiteTime:e.responseStart-e.navigationStart||0,domTime:e.domContentLoadedEventEnd-e.navigationStart||0,loadTime:e.loadEventEnd-e.navigationStart||0,parseDomTime:e.domComplete-e.domInteractive||0}}()),D("networkInformation",function(){if("connection"in r){var e=r.connection;return"object"!=typeof e?{}:(l=e.effectiveType,u=!!e.saveData,{downlink:e.downlink,effectiveType:e.effectiveType,rtt:e.rtt,saveData:!!e.saveData})}return{}}()),r&&r.storage&&"function"==typeof r.storage.estimate&&r.storage.estimate().then(X))}});
//# sourceMappingURL=index.umd.js.map
