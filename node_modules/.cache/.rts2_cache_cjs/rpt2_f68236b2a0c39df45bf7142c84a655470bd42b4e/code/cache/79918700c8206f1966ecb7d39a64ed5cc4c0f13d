{"code":"import { config } from '../config';\r\nimport { W } from '../data/constants';\r\n//rrwebÂºïÂÖ•Âà∞‰∫ÜËøôÈáå\r\nimport { AskPriority } from '../typings/types';\r\nclass ErrorTrace {\r\n    constructor() {\r\n        this.errordefo = {};\r\n    }\r\n    //ÂÖ®Â±ÄÊçïËé∑ÂêåÊ≠•+ÂºÇÊ≠•ÈîôËØØ\r\n    globalError() {\r\n        console.log('‰∏äÊä•sdk');\r\n        console.log('[ ‚ùåÂÖ®Â±ÄÊçïËé∑ÈîôËØØ ]');\r\n        W.onerror = (eventOrMessage, scriptURI, lineno, colno, error) => {\r\n            console.log('[ ÊàëÁü•ÈÅìÈîôËØØ‰∫Ü ]', eventOrMessage);\r\n            const errorInfo = JSON.stringify({\r\n                scriptURI,\r\n                lineno,\r\n                colno,\r\n                error,\r\n            });\r\n            //ÈÄöËøáÈîôËØØ‰ø°ÊÅØËøòÂéüsourcemapÊ∫êÊñá‰ª∂Âú∞ÂùÄ\r\n            console.log(errorInfo);\r\n            config.reportData.sendToAnalytics(AskPriority.IDLE, errorInfo);\r\n            return true;\r\n        };\r\n    }\r\n    //ËµÑÊ∫êÊåÇËΩΩÂ§±Ë¥• Â¶Ç404png\r\n    networkError() {\r\n        W.addEventListener('error', function (e) {\r\n            if (e.target !== W) {\r\n                console.log('üñºÁΩëÁªúÈîôËØØ', e.target);\r\n            }\r\n        }, true);\r\n    }\r\n    //ÂºÇÊ≠•PromiseÈîôËØØ\r\n    promiseError() {\r\n        W.addEventListener('unhandledrejection', function (e) {\r\n            e.preventDefault();\r\n            console.log('ÊàëÁü•ÈÅì promise ÁöÑÈîôËØØ‰∫Ü', e.reason);\r\n            return true;\r\n        });\r\n    }\r\n    iframeError() {\r\n        const frames = W.frames;\r\n        for (let i = 0; i < frames.length; i++) {\r\n            frames[i].addEventListener('error', (e) => {\r\n                console.log('addEventListener');\r\n                console.log(e);\r\n            }, true);\r\n            frames[i].addEventListener('unhandledrejection', function (e) {\r\n                console.log('unhandledrejection');\r\n            }, true);\r\n        }\r\n    }\r\n    // private consoleReflect() {\r\n    //   const console_error = W.console.error;\r\n    //   W.console.error = function () {\r\n    //     config.reportData.sendToAnalytics(AskPriority.IDLE, errorInfo);\r\n    //     console_error.apply(window, arguments);\r\n    //   };\r\n    // }\r\n    run() {\r\n        this.networkError();\r\n        //Ëß¶ÂèëÂÖ®‰ΩìÊï∞ÊçÆÁõëÂê¨ÈîôËØØ\r\n        this.globalError();\r\n        //Ëß¶ÂèëpromiseÁöÑÈîôËØØ\r\n        this.promiseError();\r\n    }\r\n}\r\nexport default ErrorTrace;\r\n//# sourceMappingURL=index.js.map","references":["/Users/wangyuan/Desktop/hiker-monitor/src/config/index.ts","/Users/wangyuan/Desktop/hiker-monitor/src/data/constants.ts","/Users/wangyuan/Desktop/hiker-monitor/src/typings/types.ts"],"map":"{\"version\":3,\"file\":\"index.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/error/index.ts\"],\"names\":[],\"mappings\":\"AAAA,OAAO,EAAE,MAAM,EAAE,MAAM,WAAW,CAAC;AACnC,OAAO,EAAE,CAAC,EAAE,MAAM,mBAAmB,CAAC;AACtC,aAAa;AACb,OAAO,EAAE,WAAW,EAAE,MAAM,kBAAkB,CAAC;AAE/C,MAAM,UAAU;IAEd;QACE,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;IACtB,CAAC;IACD,aAAa;IACL,WAAW;QACjB,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;QACrB,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;QAC3B,CAAC,CAAC,OAAO,GAAG,CACV,cAA8B,EAC9B,SAAkB,EAClB,MAAe,EACf,KAAc,EACd,KAAa,EACJ,EAAE;YACX,OAAO,CAAC,GAAG,CAAC,YAAY,EAAE,cAAc,CAAC,CAAC;YAC1C,MAAM,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC;gBAC/B,SAAS;gBACT,MAAM;gBACN,KAAK;gBACL,KAAK;aACN,CAAC,CAAC;YACH,wBAAwB;YACxB,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;YACvB,MAAM,CAAC,UAAU,CAAC,eAAe,CAAC,WAAW,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;YAC/D,OAAO,IAAI,CAAC;QACd,CAAC,CAAC;IACJ,CAAC;IACD,gBAAgB;IACR,YAAY;QAClB,CAAC,CAAC,gBAAgB,CAChB,OAAO,EACP,UAAU,CAAa;YACrB,IAAI,CAAC,CAAC,MAAM,KAAK,CAAC,EAAE;gBAClB,OAAO,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC;aACjC;QACH,CAAC,EACD,IAAI,CACL,CAAC;IACJ,CAAC;IACD,aAAa;IACL,YAAY;QAClB,CAAC,CAAC,gBAAgB,CAAC,oBAAoB,EAAE,UAAU,CAAC;YAClD,CAAC,CAAC,cAAc,EAAE,CAAC;YACnB,OAAO,CAAC,GAAG,CAAC,kBAAkB,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC;YAC1C,OAAO,IAAI,CAAC;QACd,CAAC,CAAC,CAAC;IACL,CAAC;IACO,WAAW;QACjB,MAAM,MAAM,GAAG,CAAC,CAAC,MAAM,CAAC;QACxB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACtC,MAAM,CAAC,CAAC,CAAC,CAAC,gBAAgB,CACxB,OAAO,EACP,CAAC,CAAC,EAAE,EAAE;gBACJ,OAAO,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC;gBAChC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;YACjB,CAAC,EACD,IAAI,CACL,CAAC;YAEF,MAAM,CAAC,CAAC,CAAC,CAAC,gBAAgB,CACxB,oBAAoB,EACpB,UAAU,CAAC;gBACT,OAAO,CAAC,GAAG,CAAC,oBAAoB,CAAC,CAAC;YACpC,CAAC,EACD,IAAI,CACL,CAAC;SACH;IACH,CAAC;IACD,6BAA6B;IAC7B,2CAA2C;IAC3C,oCAAoC;IACpC,sEAAsE;IACtE,8CAA8C;IAC9C,OAAO;IACP,IAAI;IACG,GAAG;QACR,IAAI,CAAC,YAAY,EAAE,CAAC;QACpB,YAAY;QACZ,IAAI,CAAC,WAAW,EAAE,CAAC;QACnB,cAAc;QACd,IAAI,CAAC,YAAY,EAAE,CAAC;IACtB,CAAC;CACF;AACD,eAAe,UAAU,CAAC\"}","dts":{"name":"/Users/wangyuan/Desktop/hiker-monitor/dist/error/index.d.ts","writeByteOrderMark":false,"text":"declare class ErrorTrace {\r\n    private errordefo;\r\n    constructor();\r\n    private globalError;\r\n    private networkError;\r\n    private promiseError;\r\n    private iframeError;\r\n    run(): void;\r\n}\r\nexport default ErrorTrace;\r\n"}}
